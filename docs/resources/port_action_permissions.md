---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "port_action_permissions Resource - terraform-provider-port-labs"
subcategory: ""
description: |-
  Action Permissions resource
  Docs for the Action Permissions resource can be found here https://docs.getport.io/actions-and-automations/create-self-service-experiences/set-self-service-actions-rbac/?config-method=terraform.
  Example Usage
  hcl
  resource "port_action_permissions" "restart_microservice_permissions" {
      action_identifier = port_action.restart_microservice.identifier
      permissions = {
          "execute" : {
              "roles" : [
                  "admin"
              ],
              "users" : [],
              "teams" : [],
              "owned_by_team" : true
          },
          "approve" : {
              "roles" : ["member", "admin"],
              "users" : [],
              "teams" : []
          }
      }
  }
  
  Example Usage with Policy
  Port allows setting dynamic permissions for executing and/or approving execution of self-service actions, based on any properties/relations of an action's corresponding blueprint.
  Docs about the Policy language can be found here https://docs.getport.io/create-self-service-experiences/set-self-service-actions-rbac/dynamic-permissions#configuring-permissions.
  Policy is expected to be passed as a JSON string and not as an object, this means that the evaluation of the policy will be done by Port and not by Terraform.
  To pass a JSON string to Terraform, you can use the jsonencode https://developer.hashicorp.com/terraform/language/functions/jsonencode function.
  ```hcl
  resource "portactionpermissions" "restartmicroservicepermissions" {
    actionidentifier = portaction.restartmicroservice.identifier
    permissions = {
      "execute" : {
        "roles" : [
          "Admin"
        ],
        "users" : [],
        "teams" : [],
        "ownedbyteam" : true
      },
      "approve" : {
        "roles" : ["Member", "Admin"],
        "users" : [],
        "teams" : []
        # Terraform's "jsonencode" function converts a
        # Terraform expression result to valid JSON syntax.
        "policy" : jsonencode(
          {
            queries : {
              executingUser : {
                rules : [
                  {
                    value : "user",
                    operator : "=",
                    property : "$blueprint"
                  },
                  {
                    value : "true",
                    operator : "=",
                    property : "$ownedby_team"
              }
            ],
            combinator : "and"
          }
        },
        conditions : [
        "true"]
      }
    )
  }
  
  }
  }
  ```
  Disclaimer
  Action permissions are created by default when creating a new action, this means that you should use this resource when you want to change the default permissions of an action.When deleting an action permissions resource using terraform, the action permissions will not be deleted from Port, as they are required for the action to work, instead, the action permissions will be removed from the terraform state.All the permission lists (roles, users, teams) are managed by Port in a sorted manner, this means that if your .tf has for example roles defined out of order, your state will be invalid
  E.g:
  hcl
  resource "port_action_permissions" "restart_microservice_permissions" {
      action_identifier = port_action.restart_microservice.identifier
      permissions = {
          # invalid
          "execute" : {
              "roles" : [
                  "member",
                  "admin",
              ],
              ...
          },
          # valid
          "approve" : {
              "roles" : [
                  "admin",
                  "member",
              ],
          }
      }
  }
---

# port_action_permissions (Resource)

# Action Permissions resource

Docs for the Action Permissions resource can be found [here](https://docs.getport.io/actions-and-automations/create-self-service-experiences/set-self-service-actions-rbac/?config-method=terraform).

## Example Usage

```hcl
resource "port_action_permissions" "restart_microservice_permissions" {
	action_identifier = port_action.restart_microservice.identifier
	permissions = {
		"execute" : {
			"roles" : [
				"admin"
			],
			"users" : [],
			"teams" : [],
			"owned_by_team" : true
		},
		"approve" : {
			"roles" : ["member", "admin"],
			"users" : [],
			"teams" : []
		}
	}
}
```

## Example Usage with Policy

Port allows setting dynamic permissions for executing and/or approving execution of self-service actions, based on any properties/relations of an action's corresponding blueprint.

Docs about the Policy language can be found [here](https://docs.getport.io/create-self-service-experiences/set-self-service-actions-rbac/dynamic-permissions#configuring-permissions).

Policy is expected to be passed as a JSON string and not as an object, this means that the evaluation of the policy will be done by Port and not by Terraform.
To pass a JSON string to Terraform, you can use the [jsonencode](https://developer.hashicorp.com/terraform/language/functions/jsonencode) function.

```hcl
resource "port_action_permissions" "restart_microservice_permissions" {
  action_identifier = port_action.restart_microservice.identifier
  permissions = {
    "execute" : {
      "roles" : [
        "Admin"
      ],
      "users" : [],
      "teams" : [],
      "owned_by_team" : true
    },
    "approve" : {
      "roles" : ["Member", "Admin"],
      "users" : [],
      "teams" : []
      # Terraform's "jsonencode" function converts a
      # Terraform expression result to valid JSON syntax.
      "policy" : jsonencode(
        {
          queries : {
            executingUser : {
              rules : [
                {
                  value : "user",
                  operator : "=",
                  property : "$blueprint"
                },
                {
                  value : "true",
                  operator : "=",
                  property : "$owned_by_team"

                }
              ],
              combinator : "and"
            }
          },
          conditions : [
          "true"]
        }
      )
    }
  }
}
```

## Disclaimer

- Action permissions are created by default when creating a new action, this means that you should use this resource when you want to change the default permissions of an action.
- When deleting an action permissions resource using terraform, the action permissions will not be deleted from Port, as they are required for the action to work, instead, the action permissions will be removed from the terraform state.
- All the permission lists (roles, users, teams) are managed by Port in a sorted manner, this means that if your `.tf` has for example roles defined out of order, your state will be invalid
    E.g:

    ```hcl
	resource "port_action_permissions" "restart_microservice_permissions" {
		action_identifier = port_action.restart_microservice.identifier
		permissions = {
			# invalid
			"execute" : {
				"roles" : [
					"member",
					"admin",
				],
				...
			},
			# valid
			"approve" : {
				"roles" : [
					"admin",
					"member",
				],
			}
		}
	}
```



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `action_identifier` (String) The ID of the action
- `permissions` (Attributes) The permissions for the action (see [below for nested schema](#nestedatt--permissions))

### Optional

- `blueprint_identifier` (String, Deprecated) The ID of the blueprint

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedatt--permissions"></a>
### Nested Schema for `permissions`

Required:

- `approve` (Attributes) The permission to approve the action's runs (see [below for nested schema](#nestedatt--permissions--approve))
- `execute` (Attributes) The permission to execute the action (see [below for nested schema](#nestedatt--permissions--execute))

<a id="nestedatt--permissions--approve"></a>
### Nested Schema for `permissions.approve`

Optional:

- `policy` (String) The policy to use for approval
- `roles` (List of String) The roles with approval permission
- `teams` (List of String) The teams with approval permission
- `users` (List of String) The users with approval permission


<a id="nestedatt--permissions--execute"></a>
### Nested Schema for `permissions.execute`

Optional:

- `owned_by_team` (Boolean) Give execution permission to the teams who own the entity
- `policy` (String) The policy to use for execution
- `roles` (List of String) The roles with execution permission
- `teams` (List of String) The teams with execution permission
- `users` (List of String) The users with execution permission
